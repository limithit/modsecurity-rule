SecRule REQUEST_HEADERS:User-Agent "@contains ${jndi:ldap:/" \
    "id:1000001,\
    phase:request,\
    deny,\
    status:403,\
    log,\
    msg:'Possible log4j2 RCE attack'"

SecRule REQUEST_URI "@rx ^/shiro/.*$" \
    "id:1000002,\
    phase:request,\
    deny,\
    status:403,\
    log,\
    msg:'Possible shiro bypass attack'"

SecRule REQUEST_COOKIES:JSESSIONID "@contains .." \
    "id:1000003,\
    phase:request,\
    deny,\
    status:403,\
    log,\
    msg:'Possible tomcat RCE attack'"

SecRule REQUEST_HEADERS:Referer "@contains /shiro/" \
    "id:1000004,\
    phase:request,\
    deny,\
    status:403,\
    log,\
    msg:'Possible shiro bypass attack'"


SecRule REQUEST_URI "@rx \.com$" \
    "id:1000005,\
    phase:request,\
    deny,\
    status:403,\
    log,\
    msg:'Possible spring bypass attack'"


SecRule REQUEST_HEADERS:User-Agent "@contains ${" \
    "id:1000006,\
    phase:request,\
    deny,\
    status:403,\
    log,\
    msg:'Possible log4j2 DoS attack'"

SecRule REQUEST_HEADERS:User-Agent "@contains ldap://" \
    "id:1000007,\
    phase:request,\
    deny,\
    status:403,\
    log,\
    msg:'Possible log4j2 RCE attack'"

SecRule REQUEST_HEADERS:User-Agent "@rx ^ApacheBench" \
"phase:1,t:none,log,auditlog,block,id:1000008,msg:'CVE-2022-29885 Possible DoS attack using ApacheBench'"

SecRule ARGS:login "@rx [;&|<>`$]" \
"phase:2,t:none,log,auditlog,block,id:1000011,msg:'CVE-2022-44877 Possible RCE attack using login parameter with shell metacharacters'"

SecRule ARGS:token "@rx [{}$]" \
"phase:2,t:none,log,auditlog,block,id:1000012,msg:'Yapi Possible MongoDB injection using token parameter with special characters'"

SecRule REQUEST_HEADERS:Authorization "@rx eyJhbGciOiJIUzI1NiJ9" \
"phase:1,t:none,log,auditlog,block,id:1000013,msg:'Possible Nacos default token.secret.key bypass using Authorization header with default JWT Token'"

SecRule REQUEST_FILENAME "@streq /SetupAccount/Upload.aspx" \
"chain,phase:2,t:none,log,auditlog,block,id:1000014,msg:'CNVD-2022-60632'"
SecRule REQUEST_METHOD "@streq POST" \
"chain"
SecRule REQUEST_HEADERS:Content-Type "@rx multipart/form-data" \
"chain"
SecRule FILES_TMPNAMES "@rx \.(asp|aspx|php|jsp|jspx|cer|exe|bat|cmd)$"

SecRule REQUEST_FILENAME "@rx ^/(repo-edit|repo-create|repo-delete|repo-diff|repo-revision|repo-history|repo-browse|repo-blame|repo-download)\-\d+\-\d+\.html$" \
"chain,phase:2,t:none,log,auditlog,block,id:1000015,msg:'CVE-2022-26134 Possible SQL injection or command execution using vulnerable modules'"
SecRule ARGS "@rx (select|union|concat|sleep|benchmark|outfile|dumpfile|\$\{|`)" \
"t:urlDecodeUni"

SecRule REQUEST_FILENAME "@rx ^/(pages|spaces|templates|favourite|labels|plugins|search|dashboard)\.action$" \
"chain,phase:2,t:none,log,auditlog,block,id:1000016,msg:'Possible OGNL injection using vulnerable modules'"
SecRule ARGS "@rx (\$\{|\$\{|#|\$\w+\.\w+)" \
"t:urlDecodeUni"


SecRule REQUEST_FILENAME "@streq /mgmt/tm/util/bash" \
"chain,phase:1,t:none,log,auditlog,block,id:1000018,msg:'CVE-2022-1388 Possible unauthenticated request using iControl REST'"
SecRule REQUEST_HEADERS:Authorization "@streq Basic YWRtaW46QVNhc1M=" \
"t:urlDecodeUni"

SecRule REQUEST_FILENAME "@streq /functionRouter" \
"chain,phase:2,t:none,log,auditlog,block,id:1000021,msg:'Possible SpEL injection using functionRouter'"
SecRule REQUEST_HEADERS:spring.cloud.function.routing-expression "@rx (\$\{|\$\{|#|\$\w+\.\w+)" \
"t:urlDecodeUni"

SecRule REQUEST_FILENAME "@streq /actuator/gateway" \
"chain,phase:1,t:none,log,auditlog,block,id:1000022,msg:'CVE-2022-22947 Possible unauthenticated request using Gateway Actuator'"
SecRule REQUEST_HEADERS:Authorization "@streq Basic YWRtaW46QVNhc1M=" \
"t:urlDecodeUni"

SecRule REQUEST_FILENAME "@streq /plugin/add" \
"chain,phase:2,t:none,log,auditlog,block,id:1000024,msg:'Possible remote code execution using plugin add'"
SecRule REQUEST_HEADERS:Authorization "!@streq Basic YWRtaW46QVNhc1M=" \
"t:urlDecodeUni"

SecRule REQUEST_BODY "@rx \${jndi:.*}" \
"phase:2,t:none,log,auditlog,block,id:1000025,msg:'CVE-2021-44228/CVE-2021-45046 Possible JNDI injection using Log4j'"

SecRule REQUEST_URI "@rx ^/public/plugins/.*(\.\./)+" \
    "id:1000026,\
    phase:1,\
    log,\
    deny,\
    status:403,\
    msg:'CVE-2021-43798 Grafana directory traversal attempt'"
	
	
SecRule REQUEST_URI "@rx ^/ws/v1/cluster/apps/(new-application|[^/]+)$" \
    "id:1000027,\
    phase:1,\
    log,\
    deny,\
    status:403,\
    msg:'Hadoop Yarn RPC unauthorized access attempt'"
	
	
	
SecRule REQUEST_METHOD "^POST$" "chain,msg:'OA V9',severity:ERROR,deny,status:403,id:1000045"
SecRule REQUEST_URI "/page/exportImport/uploadOperation.jsp" "chain"
SecRule REQUEST_FILENAME "@validateByteRange 1-255"

SecRule REQUEST_METHOD "^GET$" "chain,msg:'OA V8',severity:ERROR,deny,status:403,id:1000046"
SecRule REQUEST_URI "/js/hrm/getdata.jsp" "chain"
SecRule ARGS:cmd "@streq getSelectAllId" "chain"
SecRule ARGS:sql "@detectSQLi"


SecRule REQUEST_METHOD "^POST$" "chain,msg:' V9',severity:ERROR,deny,status:403,id:1000047"
SecRule REQUEST_URI "/WebReport/ReportServer" "chain"
SecRule ARGS:cmd "@streq design_save_svg" "chain"
SecRule ARGS:filePath "@contains chartmapsvg" "chain"
SecRule ARGS:filePath "@rx \.(jsp|php|asp|aspx)$"


SecRule REQUEST_METHOD "^POST$" "chain,msg:'A8',severity:ERROR,deny,status:403,id:1000048"
SecRule REQUEST_URI "/seeyon/(htmlofficeservlet|ajax.do|wpsAssistServlet)" "chain"
SecRule REQUEST_BODY "@rx \.(jsp|php|asp|aspx)$"

SecRule REQUEST_METHOD "^POST$" "chain,msg:'CVE-2021-21975„ÄÅCVE-2021-21983',severity:ERROR,deny,status:403,id:1000049"
SecRule REQUEST_URI "/casa/nodes/thumbprints" "chain"
SecRule REQUEST_BODY "@rx \.(jsp|php|asp|aspx)$"

SecRule REQUEST_METHOD "^POST$" "chain,msg:'CVE-2021-26919',severity:ERROR,deny,status:403,id:1000050"
SecRule REQUEST_URI "/druid/v2/sql" "chain"
SecRule REQUEST_BODY "@contains allowLoadLocalInfile=true"

SecRule REQUEST_METHOD "^GET$" "chain,msg:'CVE-2021-28073/CVE-2021-28074',severity:ERROR,deny,status:403,id:1000051"
SecRule REQUEST_URI "/lua/login.lua" "chain"
SecRule ARGS:referer "@contains /lua/admin" "chain"
SecRule ARGS:referer "@detectSQLi"

SecRule REQUEST_METHOD "^POST$" "chain,msg:'CVE-2021-26295',severity:ERROR,deny,status:403,id:1000052"
SecRule REQUEST_URI "/webtools/control/SOAPService" "chain"
SecRule REQUEST_BODY "@contains java.lang.Runtime"

# Block requests to iControl REST interface that contain suspicious paths or parameters
SecRule REQUEST_URI "@rx /mgmt/(shared/authn/login|tm/util/bash)" \
    "id:1000053,\
    phase:1,\
    deny,\
    status:403,\
    log,\
    msg:'CVE-2021-22986 attempt blocked'"
	
	
# Block requests to Apache Solr Config API or stream.url parameter
SecRule REQUEST_URI "@rx /config" \
    "id:1000054,\
    phase:1,\
    deny,\
    status:403,\
    log,\
    msg:'Apache Solr Config API attempt blocked'"
SecRule ARGS:stream.url "@rx ^file://" \
    "id:1000055,\
    phase:2,\
    deny,\
    status:403,\
    log,\
    msg:'Apache Solr stream.url SSRF attempt blocked'"
	

SecRule ARGS:poller_id "^[0-9]+$" "id:1000078,phase:2,t:none,deny,status:403,msg:'CVE-2022-46169'"
SecRule REQUEST_URI|REQUEST_BODY "@rx /e" "id:1000079,phase:2,t:none,deny,status:403,msg:'CVE-2022-44877'"
SecRule REQUEST_URI "@beginsWith /admin" "id:1000080,phase:2,t:none,deny,status:403,msg:'CVE-2023-22602'"
SecRule REQUEST_BODY|REQUEST_URI "@contains com.sun.security.auth.module.JndiLoginModule" "id:1000081,phase:2,t:none,deny,status:403,msg:'CVE-2023-25194'"




